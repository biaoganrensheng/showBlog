<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>wepy (二) - Blog - 努力的人生</title>
	<meta name="description" content="wepy">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta property="og:image" content="">
	<link rel="shortcut icon" href="/assets/img/blog.ico" type="image/x-icon">
	<link rel="apple-touch-icon" href="/assets/img/blog.ico">
	<link rel="apple-touch-icon" sizes="72x72" href="/assets/img/blog.ico">
	<link rel="apple-touch-icon" sizes="114x114" href="/assets/img/blog.ico">
	<!-- Chrome, Firefox OS and Opera -->
	<meta name="theme-color" content="#311e3e">
	<!-- Windows Phone -->
	<meta name="msapplication-navbutton-color" content="#311e3e">
	<!-- iOS Safari -->
	<meta name="apple-mobile-web-app-status-bar-style" content="#311e3e">
	
	
	
	
	<!-- Google Fonts 1
	<link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">-->
	
	
	
	
	
	<!-- Font Awesome -->
	<link rel="stylesheet" href="/assets/fonts/font-awesome/css/font-awesome.min.css">
	<!-- Styles -->
	<link rel="stylesheet" href="/assets/css/main.css">

	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>  
	
	
	<!--百度统计-->
	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "https://hm.baidu.com/hm.js?660ee541ef48f4a94f8a59dd0f9e64ae";
		  var s = document.getElementsByTagName("script")[0]; 
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>
	
	
	
	
	
	
	
	<!--谷歌统计-->
	<!-- Global site tag (gtag.js) - Google Analytics 
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-113644888-1"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'UA-113644888-1');
	</script>-->

</head>

<body>
  <div class="flex-container">
  <header class="main-header">
  <div class="wrapper">
    <div class="header-flex">
      <div class="menu-icon-container">
        <span class="menu-icon"><i class="fa fa-bars" aria-hidden="true"></i></span>
      </div>
      <nav class="main-nav">
        <span class="menu-icon-close"><i class="fa fa-times" aria-hidden="true"></i></span>
        <!--<ul style="height:800px;overflow-y:scroll;overflow-y:auto;"> -->
        <ul>
		 
			 
			 

			 

			 

			 

			 

       

       

       

       

       

       

       

       

       
       
			 <li><a  href="/"  data-hover="所有">所有(78)</a></li>
		 
			 
			 

			 

			 

			 

			 

       

       

       

       

       

       

       

       

       
       
			 <li><a  href="/blog/markdown"  data-hover="Markdown">Markdown(4)</a></li>
		 
			 
			 

			 

			 

			 

			 

       

       

       

       

       

       

       

       

       
       
			 <li><a  href="/blog/essays"  data-hover="随笔">随笔(6)</a></li>
		 
			 
			 

			 

			 

			 

			 

       

       

       

       

       

       

       

       

       
       
			 <li><a  href="/blog/jekyll"  data-hover="Jekyll">Jekyll(1)</a></li>
		 
			 
			 

			 

			 

			 

			 

       

       

       

       

       

       

       

       

       
       
			 <li><a  href="/blog/vue"  data-hover="Vue">Vue(4)</a></li>
		 
			 
			 

			 

			 

			 

			 

       

       

       

       

       

       

       

       

       
       
			 <li><a  href="/blog/react"  data-hover="React">React(2)</a></li>
		 
			 
			 

			 

			 

			 

			 

       

       

       

       

       

       

       

       

       
       
			 <li><a  href="/blog/anglur"  data-hover="Anglur">Anglur(1)</a></li>
		 
			 
			 

			 

			 

			 

			 

       

       

       

       

       

       

       

       

       
       
			 <li><a  href="/blog/youman"  data-hover="构建工具">构建工具(7)</a></li>
		 
			 
			 

			 

			 

			 

			 

       

       

       

       

       

       

       

       

       
       
			 <li><a  href="/blog/nginx2"  data-hover="Nginx2">Nginx2(1)</a></li>
		 
			 
			 

			 

			 

			 

			 

       

       

       

       

       

       

       

       

       
       
			 <li><a  href="/blog/python"  data-hover="Python">Python(2)</a></li>
		 
			 
			 

			 

			 

			 

			 

       

       

       

       

       

       

       

       

       
       
			 <li><a  href="/blog/abouttest"  data-hover="测试相关">测试相关(6)</a></li>
		 
			 
			 

			 

			 

			 

			 

       

       

       

       

       

       

       

       

       
       
			 <li><a  href="/blog/aboutweb"  data-hover="前端相关">前端相关(16)</a></li>
		 
			 
			 

			 

			 

			 

			 

       

       

       

       

       

       

       

       

       
       
			 <li><a  href="/blog/wechat"  data-hover="Wechat">Wechat(21)</a></li>
		 
			 
			 

			 

			 

			 

			 

       

       

       

       

       

       

       

       

       
       
			 <li><a  href="/blog/other"  data-hover="其它">其它(7)</a></li>
		 
          <!--<li style="margin-bottom:200px;"><a href="/about">About(7)</a></li>-->
        </ul>
      </nav>
      <p class="logo"><a href="/">nldrs</a></p>


		<div class="navbar-container">

		<div class="search-icon"><a><i class="fa fa-search" aria-hidden="true"></i></a></div>

			<div class="navbar-menu">
			   
				<a href="/"  data-hover="Home">Home</a>  <!--title="访问 Home"-->
				<!--<a href="/">Home</a>-->
					
				<a href="/about"  data-hover="About">About</a>  <!--title="访问 About"-->
				<!--<a href="/about">About</a>-->
					
			</div>


			<div class="navbar-mobile-menu" onclick="">
				<span class="icon-menu cross"><span class="middle"></span></span>
				<ul>
				   
					 <li><a href="/"data-hover="Home">Home</a></li>  <!--title="访问 Home"-->
					 <!--<li><a href="/">Home</a></li>-->
				   
					 <li><a href="/about"data-hover="About">About</a></li>  <!--title="访问 About"-->
					 <!--<li><a href="/about">About</a></li>-->
				   
				</ul>
			</div>



		</div>

    <!--  <div class="search-icon-container">
	    <a href="/" style="text-decoration: none; color: inherit;margin-right:20px;">Home</a>
		<a href="/about" style=" text-decoration: none; color: inherit;margin-right:20px;">About</a>
        <span class="search-icon"><a><i class="fa fa-search" aria-hidden="true"></i></a></span>
      </div> -->


    </div>
  </div>
</header> <!-- End Header -->

  <article class="article-page">
    <div class="page-image">
      <div class="cover-image" style="background: url(/assets/img/lpf-16.jpg) center no-repeat; background-size: cover;"></div>
    </div>
    <div class="wrapper">
      <div class="page-content">
        <div class="header-page">
          <h1 class="page-title">wepy (二)</h1>
          <div class="page-date"><time datetime="2018-09-03 20:13:00 +0800">2018, Sep 03</time>
		  <span id="busuanzi_container_page_pv"> | 访问量：<span id="busuanzi_value_page_pv"></span> 次</span>
		  </div>
        </div>
        <h1 id="微信小程序组件化开发框架wepy官方文档">微信小程序组件化开发框架WePY官方文档</h1>

<h2 id="进阶">进阶</h2>

<hr />

<p>wepy.config.js配置文件说明</p>

<p>执行wepy init standard demo后，会生成类似下面这样的配置文件。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">prod</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">===</span> <span class="s1">'production'</span><span class="p">;</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'target'</span><span class="p">:</span> <span class="s1">'dist'</span><span class="p">,</span>
    <span class="s1">'source'</span><span class="p">:</span> <span class="s1">'src'</span><span class="p">,</span>
    <span class="s1">'wpyExt'</span><span class="p">:</span> <span class="s1">'.wpy'</span><span class="p">,</span>
    <span class="s1">'compilers'</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">less</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'compress'</span><span class="p">:</span> <span class="kc">true</span>
        <span class="p">},</span>
        <span class="cm">/*sass: {
            'outputStyle': 'compressed'
        },
        postcss: {
            plugins: [
                cssnext({
                    browsers:['iOS 9', 'Android 4.4']
                })
            ]
        },*/</span>
        <span class="na">babel</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'presets'</span><span class="p">:</span> <span class="p">[</span>
                <span class="s1">'es2015'</span><span class="p">,</span>
                <span class="s1">'stage-1'</span>
            <span class="p">],</span>
            <span class="s1">'plugins'</span><span class="p">:</span> <span class="p">[</span>
                <span class="s1">'transform-export-extensions'</span><span class="p">,</span>
                <span class="s1">'syntax-export-extensions'</span><span class="p">,</span>
                <span class="s1">'transform-runtime'</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">'plugins'</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">prod</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// 压缩sass</span>
    <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">compilers</span><span class="p">[</span><span class="s1">'sass'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'outputStyle'</span><span class="p">:</span> <span class="s1">'compressed'</span><span class="p">};</span>

    <span class="c1">// 压缩less</span>
    <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">compilers</span><span class="p">[</span><span class="s1">'less'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'compress'</span><span class="p">:</span> <span class="kc">true</span><span class="p">};</span>

    <span class="c1">// 压缩js</span>
    <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">plugins</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">'uglifyjs'</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">filter</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">js$/</span><span class="p">,</span>
            <span class="na">config</span><span class="p">:</span> <span class="p">{</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s1">'imagemin'</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">filter</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.(</span><span class="sr">jpg|png|jpeg</span><span class="se">)</span><span class="sr">$/</span><span class="p">,</span>
            <span class="na">config</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">'jpg'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">quality</span><span class="p">:</span> <span class="mi">80</span>
                <span class="p">},</span>
                <span class="s1">'png'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">quality</span><span class="p">:</span> <span class="mi">80</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<p>wpyExt： 缺省值为’.wpy’，IDE默认情况下不会对此文件类型进行高亮处理，这种情况下，除了按照前文代码高亮部分的介绍进行设置之外，还可以直接将相关文件的后缀名由.wpy修改为.vue(因为与Vue的高亮规则一样)，然后将此选项修改为.vue，也能解决部分IDE中代码高亮的问题。</p>

<p>compilers： compilers为1.3.1版本之后的功能，如果需要使用其它语法，请先配置compilers，然后再安装相应的compilers。目前支持wepy-compiler-less， wepy-compiler-postcss，wepy-compiler-sass、wepy-compiler-babel、wepy-compiler-pug，其他compiler持续开发中……</p>

<p>对应各compiler请参考各自文档：</p>

<p>sass： sass编译配置，参见<a href="https://github.com/sass/node-sass">这里</a>。</p>

<p>less： less编译配置，参见<a href="http://lesscss.org/#using-less-usage-in-code">这里</a>。</p>

<p>postcss： postcss编译配置，参见<a href="http://www.css88.com/archives/7317">这里</a>。</p>

<p>stylus： stylus编译配置，参见<a href="https://www.zhangxinxu.com/jq/stylus/js.php">这里</a>。</p>

<p>babel： babel编译配置，参见<a href="http://babeljs.io/docs/en/options">这里</a>。</p>

<p>typescript： typescript编译配置，参见<a href="https://www.tslang.cn/docs/home.html">这里</a>。</p>

<p>plugins： plugins为1.1.6版本之后的功能，目前支持js压缩wepy-plugin-ugliyjs、图片压缩wepy-plugin-imagemin，其他plugin持续开发中……</p>

<h2 id="wpy文件说明">.wpy文件说明</h2>

<hr />

<p>.wpy文件的编译过程过下：</p>

<p><img src="http://ww1.sinaimg.cn/large/006uNFWmgy1fuwo13lng2j30q50akgmp.jpg" alt="" /></p>

<p>一个.wpy文件可分为三大部分，各自对应于一个标签：</p>

<p>脚本部分，即<script></script>标签中的内容，又可分为两个部分：
    逻辑部分，除了config对象之外的部分，对应于原生的.js文件；</p>

<p>    配置部分，即config对象，对应于原生的.json文件。</p>

<p>结构部分，即<template></template>模板部分，对应于原生的.wxml文件。</p>

<p>样式部分，即<style></style>样式部分，对应于原生的.wxss文件。</p>

<p>其中，小程序入口文件app.wpy不需要template，所以编译时会被忽略。.wpy文件中的script、template、style这三个标签都支持lang和src属性，lang决定了其代码编译过程，src决定是否外联代码，存在src属性且有效时，会忽略内联代码。</p>

<p>示例如下：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">style</span> <span class="nx">lang</span><span class="o">=</span><span class="s2">"less"</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"page1.less"</span><span class="o">&gt;&lt;</span><span class="sr">/style</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">template</span> <span class="nx">lang</span><span class="o">=</span><span class="s2">"wxml"</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"page1.wxml"</span><span class="o">&gt;&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
    <span class="c1">// some code</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>
<p>各标签对应的lang值如下表所示：</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">标签</th>
      <th style="text-align: left">lang默认值</th>
      <th style="text-align: left">lang支持值</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">style</td>
      <td style="text-align: left">css</td>
      <td style="text-align: left">css、less、scss、stylus、postcss</td>
    </tr>
    <tr>
      <td style="text-align: left">template</td>
      <td style="text-align: left">wxml</td>
      <td style="text-align: left">wxml、xml、pug(原jade)</td>
    </tr>
    <tr>
      <td style="text-align: left">script</td>
      <td style="text-align: left">babel</td>
      <td style="text-align: left">babel、TypeScript</td>
    </tr>
  </tbody>
</table>

<h2 id="脚本部分介绍">脚本部分介绍</h2>

<hr />

<p>小程序入口app.wpy</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">app</span> <span class="p">{</span>
    <span class="nx">config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"pages"</span><span class="p">:[</span>
            <span class="s2">"pages/index/index"</span>
        <span class="p">],</span>
        <span class="s2">"window"</span><span class="p">:{</span>
            <span class="s2">"backgroundTextStyle"</span><span class="p">:</span> <span class="s2">"light"</span><span class="p">,</span>
            <span class="s2">"navigationBarBackgroundColor"</span><span class="p">:</span> <span class="s2">"#fff"</span><span class="p">,</span>
            <span class="s2">"navigationBarTitleText"</span><span class="p">:</span> <span class="s2">"WeChat"</span><span class="p">,</span>
            <span class="s2">"navigationBarTextStyle"</span><span class="p">:</span> <span class="s2">"black"</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">onLaunch</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">style</span> <span class="nx">lang</span><span class="o">=</span><span class="s2">"less"</span><span class="o">&gt;</span>
<span class="cm">/** less **/</span>
<span class="o">&lt;</span><span class="sr">/style</span><span class="err">&gt;
</span>
</code></pre></div></div>

<p>入口文件app.wpy中所声明的小程序实例继承自wepy.app类，包含一个config属性和其它全局属性、方法、事件。其中config属性对应原生的app.json文件，build编译时会根据config属性自动生成app.json文件，如果需要修改config中的内容，请使用微信提供的相关API。</p>

<h2 id="页面pagewpy">页面page.wpy</h2>

<hr />

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Counter</span> <span class="k">from</span> <span class="s1">'../components/counter'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Page</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">page</span> <span class="p">{</span>
    <span class="nx">config</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">components</span> <span class="o">=</span> <span class="p">{</span><span class="na">counter1</span><span class="p">:</span> <span class="nx">Counter</span><span class="p">};</span>

    <span class="nx">data</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">methods</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="nx">events</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">onLoad</span><span class="p">()</span> <span class="p">{};</span>
    <span class="c1">// Other properties</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">template</span> <span class="nx">lang</span><span class="o">=</span><span class="s2">"wxml"</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">view</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="sr">/view</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="nx">counter1</span><span class="o">&gt;&lt;</span><span class="sr">/counter1</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">style</span> <span class="nx">lang</span><span class="o">=</span><span class="s2">"less"</span><span class="o">&gt;</span>
<span class="cm">/** less **/</span>
<span class="o">&lt;</span><span class="sr">/style</span><span class="err">&gt;
</span></code></pre></div></div>

<p>页面文件page.wpy中所声明的页面实例继承自wepy.page类，该类的主要属性介绍如下：</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">属性</th>
      <th style="text-align: left">说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">config</td>
      <td style="text-align: left">页面配置对象，对应于原生的page.json文件，类似于app.wpy中的config</td>
    </tr>
    <tr>
      <td style="text-align: center">components</td>
      <td style="text-align: left">页面组件列表对象，声明页面所引入的组件列表</td>
    </tr>
    <tr>
      <td style="text-align: center">data</td>
      <td style="text-align: left">页面渲染数据对象，存放可用于页面模板绑定的渲染数据</td>
    </tr>
    <tr>
      <td style="text-align: center">methods</td>
      <td style="text-align: left">wxml事件处理函数对象，存放响应wxml中所捕获到的事件的函数，如bindtap、bindchange</td>
    </tr>
    <tr>
      <td style="text-align: center">events</td>
      <td style="text-align: left">WePY组件事件处理函数对象，存放响应组件之间通过$broadcast、$emit、$invoke所传递的事件的函数</td>
    </tr>
    <tr>
      <td style="text-align: center">其它</td>
      <td style="text-align: left">小程序页面生命周期函数，如onLoad、onReady等，以及其它自定义的方法与属性</td>
    </tr>
  </tbody>
</table>

<h2 id="组件comwpy">组件com.wpy</h2>

<hr />

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">template</span> <span class="nx">lang</span><span class="o">=</span><span class="s2">"wxml"</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">view</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="sr">/view</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Com</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">component</span> <span class="p">{</span>
    <span class="nx">components</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="nx">data</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">methods</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="nx">events</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="c1">// Other properties</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">style</span> <span class="nx">lang</span><span class="o">=</span><span class="s2">"less"</span><span class="o">&gt;</span>
<span class="cm">/** less **/</span>
<span class="o">&lt;</span><span class="sr">/style</span><span class="err">&gt;
</span></code></pre></div></div>

<p>组件文件com.wpy中所声明的组件实例继承自wepy.component类，除了不需要config配置以及页面特有的一些生命周期函数之外，其属性与页面属性大致相同。</p>

<h2 id="实例">实例</h2>

<hr />

<p>通过前文的介绍可知，在 WePY 中，小程序被分为三个实例：小程序实例App、页面实例Page、组件实例Component。其中Page实例继承自Component。各自的声明方式如下：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>

<span class="c1">// 声明一个App小程序实例</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">MyAPP</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">app</span> <span class="p">{</span>
<span class="p">}</span>

<span class="c1">// 声明一个Page页面实例</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">IndexPage</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">page</span> <span class="p">{</span>
<span class="p">}</span>

<span class="c1">// 声明一个Component组件实例</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">MyComponent</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">component</span> <span class="p">{</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="app小程序实例">App小程序实例</h2>

<hr />

<p>App小程序实例中主要包含小程序生命周期函数、config配置对象、globalData全局数据对象，以及其他自定义方法与属性。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">MyAPP</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">app</span> <span class="p">{</span>
    <span class="nx">customData</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="nx">customFunction</span> <span class="p">()</span><span class="err">　</span><span class="p">{</span> <span class="p">}</span>

    <span class="nx">onLaunch</span> <span class="p">()</span> <span class="p">{}</span>

    <span class="nx">onShow</span> <span class="p">()</span> <span class="p">{}</span>

    <span class="nx">config</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1">// 对应 app.json 文件</span>

    <span class="nx">globalData</span> <span class="o">=</span> <span class="p">{}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">在Page页面实例中，可以通过this.$parent来访问App实例。</code></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">MyPage</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">page</span> <span class="p">{</span>
<span class="c1">// export default class MyComponent extends wepy.component {</span>
    <span class="nx">customData</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1">// 自定义数据</span>

    <span class="nx">customFunction</span> <span class="p">()</span><span class="err">　</span><span class="p">{}</span>  <span class="c1">//自定义方法</span>

    <span class="nx">onLoad</span> <span class="p">()</span> <span class="p">{}</span>  <span class="c1">// 在Page和Component共用的生命周期函数</span>

    <span class="nx">onShow</span> <span class="p">()</span> <span class="p">{}</span>  <span class="c1">// 只在Page中存在的页面生命周期函数</span>

    <span class="nx">config</span> <span class="o">=</span> <span class="p">{};</span>  <span class="c1">// 只在Page实例中存在的配置数据，对应于原生的page.json文件</span>

    <span class="nx">data</span> <span class="o">=</span> <span class="p">{};</span>  <span class="c1">// 页面所需数据均需在这里声明，可用于模板数据绑定</span>

    <span class="nx">components</span> <span class="o">=</span> <span class="p">{};</span>  <span class="c1">// 声明页面中所引用的组件，或声明组件中所引用的子组件</span>

    <span class="nx">mixins</span> <span class="o">=</span> <span class="p">[];</span>  <span class="c1">// 声明页面所引用的Mixin实例</span>

    <span class="nx">computed</span> <span class="o">=</span> <span class="p">{};</span>  <span class="c1">// 声明计算属性（详见后文介绍）</span>

    <span class="nx">watch</span> <span class="o">=</span> <span class="p">{};</span>  <span class="c1">// 声明数据watcher（详见后文介绍）</span>

    <span class="nx">methods</span> <span class="o">=</span> <span class="p">{};</span>  <span class="c1">// 声明页面wxml中标签的事件处理函数。注意，此处只用于声明页面wxml中标签的bind、catch事件，自定义方法需以自定义方法的方式声明</span>

    <span class="nx">events</span> <span class="o">=</span> <span class="p">{};</span>  <span class="c1">// 声明组件之间的事件处理函数</span>
<span class="p">}</span>
</code></pre></div></div>

<p>注意，对于WePY中的methods属性，因为与Vue中的使用习惯不一致，非常容易造成误解，这里需要特别强调一下：WePY中的methods属性只能声明页面wxml标签的bind、catch事件，不能声明自定义方法，这与Vue中的用法是不一致的。示例如下：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 错误示例</span>

<span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">MyComponent</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">component</span> <span class="p">{</span>
    <span class="nx">methods</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">bindtap</span> <span class="p">()</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">rst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">commonFunc</span><span class="p">();</span>
            <span class="c1">// doSomething</span>
        <span class="p">},</span>

        <span class="nx">bindinput</span> <span class="p">()</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">rst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">commonFunc</span><span class="p">();</span>
            <span class="c1">// doSomething</span>
        <span class="p">},</span>

        <span class="c1">//错误：普通自定义方法不能放在methods对象中</span>
        <span class="nx">customFunction</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s1">'sth.'</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>

<span class="p">}</span>


<span class="c1">// 正确示例</span>

<span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">MyComponent</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">component</span> <span class="p">{</span>
    <span class="nx">methods</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">bindtap</span> <span class="p">()</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">rst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">commonFunc</span><span class="p">();</span>
            <span class="c1">// doSomething</span>
        <span class="p">},</span>

        <span class="nx">bindinput</span> <span class="p">()</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">rst</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">commonFunc</span><span class="p">();</span>
            <span class="c1">// doSomething</span>
        <span class="p">},</span>
    <span class="p">}</span>

    <span class="c1">//正确：普通自定义方法在methods对象外声明，与methods平级</span>
    <span class="nx">customFunction</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">'sth.'</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div>

<h2 id="组件">组件</h2>

<hr />

<p>原生小程序支持js模块化，但彼此独立，业务代码与交互事件仍需在页面处理。无法实现组件化的松耦合与复用的效果。</p>

<p>例如模板A中绑定一个bindtap=”myclick”，模板B中同样绑定一样bindtap=”myclick”，那么就会影响同一个页面事件。对于数据同样如此。因此，只有通过改变变量或者事件方法，或者给其加不同前缀才能实现绑定不同事件或者不同数据。当页面复杂之后就十分不利于开发维护。</p>

<p>因此，在WePY中实现了小程序的组件化开发，组件的所有业务与功能在组件本身实现，组件与组件之间彼此隔离，上述例子在WePY的组件化开发过程中，A组件只会影响到A所绑定的myclick，B也如此。</p>

<p><img src="http://ww1.sinaimg.cn/large/006uNFWmgy1fuwov6cz5pj30pg0fuq44.jpg" alt="" /></p>

<h2 id="普通组件引用">普通组件引用</h2>

<hr />

<p>当页面需要引入组件或组件需要引入子组件时，必须在.wpy文件的<script>脚本部分先import组件文件，然后在components对象中给组件声明唯一的组件ID，接着在<template>模板部分中添加以components对象中所声明的组件ID进行命名的自定义标签以插入组件。如：</template></script></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
project
└── src
    ├── components
    |   └── child.wpy
    ├── pages
    |   ├── index.wpy    index 页面配置、结构、样式、逻辑
    |   └── log.wpy      log 页面配置、结构、样式、逻辑
    └──app.wpy           小程序配置项（全局公共配置、公共样式、声明钩子等）
**/</span>

<span class="c1">// index.wpy</span>

<span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
    <span class="c">&lt;!--</span> <span class="err">以</span><span class="s2">`&lt;script&gt;`</span><span class="err">脚本部分中所声明的组件</span><span class="nx">ID</span><span class="err">为名命名自定义标签，从而在</span><span class="s2">`&lt;template&gt;`</span><span class="err">模板部分中插入组件</span> <span class="o">--&gt;</span>
    <span class="o">&lt;</span><span class="nx">child</span><span class="o">&gt;&lt;</span><span class="sr">/child</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
    <span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>
    <span class="c1">//引入组件文件</span>
    <span class="k">import</span> <span class="nx">Child</span> <span class="k">from</span> <span class="s1">'../components/child'</span><span class="p">;</span>

    <span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Index</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">component</span> <span class="p">{</span>
        <span class="c1">//声明组件，分配组件id为child</span>
        <span class="nx">components</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">child</span><span class="p">:</span> <span class="nx">Child</span>
        <span class="p">};</span>
    <span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<p>需要注意的是，WePY中的组件都是静态组件，是以组件ID作为唯一标识的，每一个ID都对应一个组件实例，当页面引入两个相同ID的组件时，这两个组件共用同一个实例与数据，当其中一个组件数据变化时，另外一个也会一起变化。</p>

<p>如果需要避免这个问题，则需要分配多个组件ID和实例。代码如下：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">view</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"child1"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">child</span><span class="o">&gt;&lt;</span><span class="sr">/child</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/view</span><span class="err">&gt;
</span>
    <span class="o">&lt;</span><span class="nx">view</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"child2"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">anotherchild</span><span class="o">&gt;&lt;</span><span class="sr">/anotherchild</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/view</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>

<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
    <span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>
    <span class="k">import</span> <span class="nx">Child</span> <span class="k">from</span> <span class="s1">'../components/child'</span><span class="p">;</span>

    <span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Index</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">component</span> <span class="p">{</span>
        <span class="nx">components</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1">//为两个相同组件的不同实例分配不同的组件ID，从而避免数据同步变化的问题</span>
            <span class="na">child</span><span class="p">:</span> <span class="nx">Child</span><span class="p">,</span>
            <span class="na">anotherchild</span><span class="p">:</span> <span class="nx">Child</span>
        <span class="p">};</span>
    <span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>
<blockquote>
  <p>注意：WePY中，在父组件template模板部分插入驼峰式命名的子组件标签时，不能将驼峰式命名转换成短横杆式命名(比如将childCom转换成child-com)，这与Vue中的习惯是不一致。</p>
</blockquote>

<h2 id="组件的循环渲染">组件的循环渲染</h2>
<p><code class="highlighter-rouge">1.4.6新增</code></p>

<p>当需要循环渲染WePY组件时(类似于通过wx:for循环渲染原生的wxml标签)，必须使用WePY定义的辅助标签<code class="highlighter-rouge">&lt;repeat&gt;</code>，代码如下：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
project
└── src
    ├── components
    |   └── child.wpy
    ├── pages
    |   ├── index.wpy    index 页面配置、结构、样式、逻辑
    |   └── log.wpy      log 页面配置、结构、样式、逻辑
    └──app.wpy           小程序配置项（全局样式配置、声明钩子等）
**/</span>

<span class="c1">// index.wpy</span>

<span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
    <span class="c">&lt;!--</span> <span class="err">注意，使用</span><span class="k">for</span><span class="err">属性，而不是使用</span><span class="nx">wx</span><span class="p">:</span><span class="k">for</span><span class="err">属性</span> <span class="o">--&gt;</span>
    <span class="o">&lt;</span><span class="nx">repeat</span> <span class="k">for</span><span class="o">=</span><span class="s2">""</span> <span class="nx">key</span><span class="o">=</span><span class="s2">"index"</span> <span class="nx">index</span><span class="o">=</span><span class="s2">"index"</span> <span class="nx">item</span><span class="o">=</span><span class="s2">"item"</span><span class="o">&gt;</span>
        <span class="c">&lt;!--</span> <span class="err">插入</span><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="err">脚本部分所声明的</span><span class="nx">child</span><span class="err">组件，同时传入</span><span class="nx">item</span> <span class="o">--&gt;</span>
        <span class="o">&lt;</span><span class="nx">child</span> <span class="p">:</span><span class="nx">item</span><span class="o">=</span><span class="s2">"item"</span><span class="o">&gt;&lt;</span><span class="sr">/child</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/repeat</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
    <span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>
    <span class="c1">// 引入child组件文件</span>
    <span class="k">import</span> <span class="nx">Child</span> <span class="k">from</span> <span class="s1">'../components/child'</span><span class="p">;</span>

    <span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Index</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">component</span> <span class="p">{</span>
        <span class="nx">components</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1">// 声明页面中要使用到的Child组件的ID为child</span>
            <span class="na">child</span><span class="p">:</span> <span class="nx">Child</span>
        <span class="p">}</span>

        <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">list</span><span class="p">:</span> <span class="p">[{</span><span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">title</span><span class="p">:</span> <span class="s1">'title1'</span><span class="p">},</span> <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="na">title</span><span class="p">:</span> <span class="s1">'title2'</span><span class="p">}]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>
<p><img src="http://ww1.sinaimg.cn/large/006uNFWmgy1fuwp1lcevkj30ud0dqq45.jpg" alt="" /></p>

<h2 id="computed-计算属性">computed 计算属性</h2>

<hr />

<p>类型: { [key: string]: Function }</p>

<p>详细：</p>

<p>computed计算属性，是一个有返回值的函数，可直接被当作绑定数据来使用。因此类似于data属性，代码中可通过this.计算属性名来引用，模板中也可通过来绑定数据。</p>

<p>需要注意的是，只要是组件中有任何数据发生了改变，那么所有计算属性就都会被重新计算。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">a</span><span class="p">:</span> <span class="mi">1</span>
  <span class="p">}</span>

  <span class="c1">// 计算属性aPlus，在脚本中可通过this.aPlus来引用，在模板中可通过来插值</span>
  <span class="nx">computed</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">aPlus</span> <span class="p">()</span> <span class="p">{</span>
          <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">a</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></div>

<h2 id="watcher-监听器">watcher 监听器</h2>

<hr />

<p>类型: { [key: string]: Function }</p>

<p>详细：</p>

<p>通过监听器watcher能够监听到任何属性的更新。监听器在watch对象中声明，类型为函数，函数名与需要被监听的data对象中的属性同名，每当被监听的属性改变一次，监听器函数就会被自动调用执行一次。</p>

<p>监听器适用于当属性改变时需要进行某些额外处理的情形。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">num</span><span class="p">:</span> <span class="mi">1</span>
  <span class="p">}</span>

  <span class="c1">// 监听器函数名必须跟需要被监听的data对象中的属性num同名，</span>
  <span class="c1">// 其参数中的newValue为属性改变后的新值，oldValue为改变前的旧值</span>
  <span class="nx">watch</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">num</span> <span class="p">(</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`num value: </span><span class="p">${</span><span class="nx">oldValue</span><span class="p">}</span><span class="s2"> -&gt; </span><span class="p">${</span><span class="nx">newValue</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
      <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// 每当被监听的属性num改变一次，对应的同名监听器函数num()就被自动调用执行一次</span>
  <span class="nx">onLoad</span> <span class="p">()</span> <span class="p">{</span>
      <span class="nx">setInterval</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">num</span><span class="o">++</span><span class="p">;</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">$apply</span><span class="p">();</span>
      <span class="p">},</span> <span class="mi">1000</span><span class="p">)</span>
  <span class="p">}</span>
</code></pre></div></div>

<h2 id="props-传值">props 传值</h2>

<hr />

<p>props传值在WePY中属于父子组件之间传值的一种机制，包括静态传值与动态传值。</p>

<p>在props对象中声明需要传递的值，静态传值与动态传值的声明略有不同，具体可参看下面的示例代码。</p>

<p>静态传值</p>

<p>静态传值为父组件向子组件传递常量数据，因此只能传递String字符串类型。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">child</span> <span class="nx">title</span><span class="o">=</span><span class="s2">"mytitle"</span><span class="o">&gt;&lt;</span><span class="sr">/child</span><span class="err">&gt;
</span>
<span class="c1">// child.wpy</span>
<span class="nx">props</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">title</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">};</span>

<span class="nx">onLoad</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">title</span><span class="p">);</span> <span class="c1">// mytitle</span>
<span class="p">}</span>
</code></pre></div></div>

<p>在父组件template模板部分的组件标签中，使用子组件props对象中所声明的属性名作为其属性名来接收父组件传递的值。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">child</span> <span class="nx">title</span><span class="o">=</span><span class="s2">"mytitle"</span><span class="o">&gt;&lt;</span><span class="sr">/child</span><span class="err">&gt;
</span>
<span class="c1">// child.wpy</span>
<span class="nx">props</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">title</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">};</span>

<span class="nx">onLoad</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">title</span><span class="p">);</span> <span class="c1">// mytitle</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="动态传值">动态传值</h2>

<hr />

<p>动态传值是指父组件向子组件传递动态数据内容，父子组件数据完全独立互不干扰。但可以通过使用.sync修饰符来达到父组件数据绑定至子组件的效果，也可以通过设置子组件props的twoWay: true来达到子组件数据绑定至父组件的效果。那如果既使用.sync修饰符，同时子组件props中添加的twoWay: true时，就可以实现数据的双向绑定了。</p>

<p>注意：下文示例中的twoWay为true时，表示子组件向父组件单向动态传值，而twoWay为false(默认值，可不写)时，则表示子组件不向父组件传值。这是与Vue不一致的地方，而这里之所以仍然使用twoWay，只是为了尽可能保持与Vue在标识符命名上的一致性。</p>

<p>在父组件template模板部分所插入的子组件标签中，使用:prop属性（等价于Vue中的v-bind:prop属性）来进行动态传值。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// parent.wpy</span>

<span class="o">&lt;</span><span class="nx">child</span> <span class="p">:</span><span class="nx">title</span><span class="o">=</span><span class="s2">"parentTitle"</span> <span class="p">:</span><span class="nx">syncTitle</span><span class="p">.</span><span class="nx">sync</span><span class="o">=</span><span class="s2">"parentTitle"</span> <span class="p">:</span><span class="nx">twoWayTitle</span><span class="o">=</span><span class="s2">"parentTitle"</span><span class="o">&gt;&lt;</span><span class="sr">/child</span><span class="err">&gt;
</span>
<span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">parentTitle</span><span class="p">:</span> <span class="s1">'p-title'</span>
<span class="p">};</span>


<span class="c1">// child.wpy</span>

<span class="nx">props</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">// 静态传值</span>
    <span class="na">title</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>

    <span class="c1">// 父向子单向动态传值</span>
    <span class="na">syncTitle</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
        <span class="na">default</span><span class="p">:</span> <span class="s1">'null'</span>
    <span class="p">},</span>

    <span class="na">twoWayTitle</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
        <span class="na">default</span><span class="p">:</span> <span class="s1">'nothing'</span><span class="p">,</span>
        <span class="na">twoWay</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">onLoad</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">title</span><span class="p">);</span> <span class="c1">// p-title</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">syncTitle</span><span class="p">);</span> <span class="c1">// p-title</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">twoWayTitle</span><span class="p">);</span> <span class="c1">// p-title</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="s1">'c-title'</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$parent</span><span class="p">.</span><span class="nx">parentTitle</span><span class="p">);</span> <span class="c1">// p-title.</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">twoWayTitle</span> <span class="o">=</span> <span class="s1">'two-way-title'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$apply</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$parent</span><span class="p">.</span><span class="nx">parentTitle</span><span class="p">);</span> <span class="c1">// two-way-title.  --- twoWay为true时，子组件props中的属性值改变时，会同时改变父组件对应的值</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$parent</span><span class="p">.</span><span class="nx">parentTitle</span> <span class="o">=</span> <span class="s1">'p-title-changed'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$parent</span><span class="p">.</span><span class="nx">$apply</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">title</span><span class="p">);</span> <span class="c1">// 'c-title';</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">syncTitle</span><span class="p">);</span> <span class="c1">// 'p-title-changed' --- 有.sync修饰符的props属性值，当在父组件中改变时，会同时改变子组件对应的值。</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="组件通信与交互">组件通信与交互</h2>

<hr />

<p>wepy.component基类提供$broadcast、$emit、$invoke三个方法用于组件之间的通信和交互，如：</p>

<blockquote>
  <p>this.$emit(‘some-event’, 1, 2, 3, 4);</p>
</blockquote>

<p>用于监听组件之间的通信与交互事件的事件处理函数需要写在组件和页面的events对象中，如：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Com</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">component</span> <span class="p">{</span>
    <span class="nx">components</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="nx">data</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="nx">methods</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="c1">// events对象中所声明的函数为用于监听组件之间的通信与交互事件的事件处理函数</span>
    <span class="nx">events</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">'some-event'</span><span class="p">:</span> <span class="p">(</span><span class="nx">p1</span><span class="p">,</span> <span class="nx">p2</span><span class="p">,</span> <span class="nx">p3</span><span class="p">,</span> <span class="nx">$event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
               <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">$name</span><span class="p">}</span><span class="s2"> receive </span><span class="p">${</span><span class="nx">$event</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2"> from </span><span class="p">${</span><span class="nx">$event</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">$name</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="c1">// Other properties</span>
</code></pre></div></div>
<p><img src="http://ww1.sinaimg.cn/large/006uNFWmgy1fuwpo1ajxyj30p50cegoa.jpg" alt="" /></p>

<p><img src="http://ww1.sinaimg.cn/large/006uNFWmgy1fuwpo935sjj30r30cx0u6.jpg" alt="" /></p>

<p>$invoke</p>

<p>$invoke是一个页面或组件对另一个组件中的方法的直接调用，通过传入组件路径找到相应的组件，然后再调用其方法。</p>

<p>比如，想在页面Page_Index中调用组件ComA的某个方法：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">$invoke</span><span class="p">(</span><span class="s1">'ComA'</span><span class="p">,</span> <span class="s1">'someMethod'</span><span class="p">,</span> <span class="s1">'someArgs'</span><span class="p">);</span>
</code></pre></div></div>

<p>如果想在组件ComA中调用组件ComG的某个方法：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">$invoke</span><span class="p">(</span><span class="s1">'./../ComB/ComG'</span><span class="p">,</span> <span class="s1">'someMethod'</span><span class="p">,</span> <span class="s1">'someArgs'</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="组件自定义事件处理函数">组件自定义事件处理函数</h2>

<hr />

<p><code class="highlighter-rouge">1.4.8新增</code></p>

<p>可以通过使用.user修饰符为自定义组件绑定事件，如：@customEvent.user=”myFn”</p>

<p>其中，@表示事件修饰符，customEvent 表示事件名称，.user表示事件后缀。</p>

<p>目前总共有三种事件后缀：</p>

<p>.default: 绑定小程序冒泡型事件，如bindtap，.default后缀可省略不写；</p>

<p>.stop: 绑定小程序捕获型事件，如catchtap；</p>

<p>.user: 绑定用户自定义组件事件，通过$emit触发。注意，如果用了自定义事件，则events中对应的监听函数不会再执行。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// index.wpy</span>

<span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">child</span> <span class="p">@</span><span class="nd">childFn</span><span class="p">.</span><span class="nx">user</span><span class="o">=</span><span class="s2">"parentFn"</span><span class="o">&gt;&lt;</span><span class="sr">/child</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
    <span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span>
    <span class="k">import</span> <span class="nx">Child</span> <span class="k">from</span> <span class="s1">'../components/child'</span>

    <span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Index</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">page</span> <span class="p">{</span>
        <span class="nx">components</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">child</span><span class="p">:</span> <span class="nx">Child</span>
        <span class="p">}</span>

        <span class="nx">methods</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">parentFn</span> <span class="p">(</span><span class="nx">num</span><span class="p">,</span> <span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'parent received emit event, number is: '</span> <span class="o">+</span> <span class="nx">num</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>

<span class="c1">// child.wpy</span>

<span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">view</span> <span class="p">@</span><span class="nd">tap</span><span class="o">=</span><span class="s2">"tap"</span><span class="o">&gt;</span><span class="nx">Click</span> <span class="nx">me</span><span class="o">&lt;</span><span class="sr">/view</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
    <span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span>

    <span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Child</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">component</span> <span class="p">{</span>
        <span class="nx">methods</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">tap</span> <span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'child is clicked'</span><span class="p">)</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">'childFn'</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span><span class="s2">``</span>

<span class="err">##</span> <span class="nx">slot</span> <span class="err">组件内容分发插槽</span>

<span class="o">**********************************</span>


<span class="nx">WePY</span><span class="err">中的</span><span class="nx">slot</span><span class="err">插槽作为内容分发标签的空间占位标签，便于在父组件中通过对相当于扩展板卡的内容分发标签的“插拔”，更为灵活、方便地对子组件进行内容分发。</span>

<span class="err">具体使用方法是，首先在子组件</span><span class="nx">template</span><span class="err">模板部分中声明</span><span class="nx">slot</span><span class="err">标签作为内容插槽，同时必须在其</span><span class="nx">name</span><span class="err">属性中指定插槽名称，还可设置默认的标签内容；然后在引入了该带有插槽的子组件的父组件</span><span class="nx">template</span><span class="err">模板部分中声明用于“插拔”的内容分发标签。</span>

<span class="err">注意，这些父组件中的内容分发标签必须具有</span><span class="nx">slot</span><span class="err">属性，并且其值为子组件中对应的插槽名称，这样父组件内容分发标签中的内容会覆盖掉子组件对应插槽中的默认内容。</span>

<span class="err">另外，要特别注意的是，父组件中一旦声明了对应于子组件插槽的内容分发标签，即便没有内容，子组件插槽中的默认内容也不会显示出来，只有删除了父组件中对应的内容分发标签，才能显示出来。</span>

<span class="err">示例：</span>

<span class="err">在</span><span class="nx">Panel</span><span class="err">组件中有以下模板：</span>

<span class="s2">```javascript
&lt;view class="panel"&gt;
    &lt;slot name="title"&gt;默认标题&lt;/slot&gt;
    &lt;slot name="content"&gt;默认内容&lt;/slot&gt;
&lt;/view&gt;
</span></code></pre></div></div>

<p>在父组件中使用Panel子组件时，可以这样使用：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">panel</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">view</span> <span class="nx">slot</span><span class="o">=</span><span class="s2">"title"</span><span class="o">&gt;</span><span class="err">新的标题</span><span class="o">&lt;</span><span class="sr">/view</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="nx">view</span> <span class="nx">slot</span><span class="o">=</span><span class="s2">"content"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">text</span><span class="o">&gt;</span><span class="err">新的内容</span><span class="o">&lt;</span><span class="sr">/text</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/view</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/panel</span><span class="err">&gt;
</span></code></pre></div></div>

<h2 id="默认式混合">默认式混合</h2>

<hr />

<p>对于组件data数据，components组件，events事件以及其它自定义方法采用默认式混合，即如果组件未声明该数据，组件，事件，自定义方法等，那么将混合对象中的选项将注入组件之中。对于组件已声明的选项将不受影响。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// mixins/test.js</span>
<span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">TestMixin</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">mixin</span> <span class="p">{</span>
    <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">foo</span><span class="p">:</span> <span class="s1">'foo defined by page'</span><span class="p">,</span>
        <span class="na">bar</span><span class="p">:</span> <span class="s1">'bar defined by testMix'</span>
    <span class="p">};</span>
    <span class="nx">methods</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">tap</span> <span class="p">()</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'mix tap'</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// pages/index.wpy</span>
<span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">TestMixin</span> <span class="k">from</span> <span class="s1">'./mixins/test'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Index</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">page</span> <span class="p">{</span>
    <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">foo</span><span class="p">:</span> <span class="s1">'foo defined by index'</span>
    <span class="p">};</span>
    <span class="nx">mixins</span> <span class="o">=</span> <span class="p">[</span><span class="nx">TestMixin</span> <span class="p">];</span>
    <span class="nx">onShow</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">foo</span><span class="p">);</span> <span class="c1">// foo defined by index</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">bar</span><span class="p">);</span> <span class="c1">// bar defined by testMix</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="兼容式混合">兼容式混合</h2>

<hr />

<p>对于组件methods响应事件，以及小程序页面事件将采用兼容式混合，即先响应组件本身响应事件，然后再响应混合对象中响应事件。注意，这里事件的执行顺序跟Vue中相反，Vue中是先执行mixin中的函数， 再执行组件本身的函数。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// mixins/test.js</span>
<span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">TestMixin</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">mixin</span> <span class="p">{</span>
    <span class="nx">methods</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">tap</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'mixin tap'</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">onShow</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'mixin onshow'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// pages/index.wpy</span>
<span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">TestMixin</span> <span class="k">from</span> <span class="s1">'./mixins/test'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Index</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">page</span> <span class="p">{</span>

    <span class="nx">mixins</span> <span class="o">=</span> <span class="p">[</span><span class="nx">TestMixin</span><span class="p">];</span>
    <span class="nx">methods</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">tap</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'index tap'</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">onShow</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'index onshow'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="c1">// index onshow</span>
<span class="c1">// mixin onshow</span>
<span class="c1">// ----- when tap</span>
<span class="c1">// index tap</span>
<span class="c1">// mixin tap</span>
</code></pre></div></div>

<h2 id="wxs-weixin-script">WXS (WeiXin Script)</h2>

<hr />

<p>WePY 从1.7.x 版本开始支持 wxs 语法，但语法与原生 wxs 稍有出入。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
project
└── src
    ├── wxs
    |   └── mywxs.wxs      wxs 文件 
    ├── pages
    |   └── index.wpy      页面
    └──app.wpy           
**/</span>

<span class="c1">// mywxs.wxs</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">text</span><span class="p">:</span> <span class="s1">'This is from wxs'</span><span class="p">,</span>
  <span class="na">filter</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">num</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">num</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// index.wpy</span>

<span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">text</span><span class="o">&gt;&lt;</span><span class="sr">/text</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="nx">text</span><span class="o">&gt;&lt;</span><span class="sr">/text</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
  <span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>
  <span class="k">import</span> <span class="nx">mywxs</span> <span class="k">from</span> <span class="s1">'../wxs/mywxs.wxs'</span><span class="p">;</span>

  <span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Index</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">page</span> <span class="p">{</span>

    <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">num</span><span class="p">:</span> <span class="mi">10</span>
    <span class="p">};</span>

    <span class="nx">wxs</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">m1</span><span class="p">:</span> <span class="nx">mywxs</span>
    <span class="p">}</span>

  <span class="p">};</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<p>注意</p>

<p>wxs是基于原生的wxs去实现的，只是通过编译把现在的语法编译为原生语法。
wxs必须是外链文件。并且后缀为.wxs。
wxs引入后只能在template中使用，不能在script中使用。</p>

<h2 id="interceptor-拦截器">interceptor 拦截器</h2>

<hr />

<p>可以使用WePY提供的全局拦截器对原生API的请求进行拦截。</p>

<p>具体方法是配置API的config、fail、success、complete回调函数。参考示例：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">app</span> <span class="p">{</span>
    <span class="kd">constructor</span> <span class="p">()</span> <span class="p">{</span>
        <span class="c1">// this is not allowed before super()</span>
        <span class="k">super</span><span class="p">();</span>
        <span class="c1">// 拦截request请求</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">intercept</span><span class="p">(</span><span class="s1">'request'</span><span class="p">,</span> <span class="p">{</span>
            <span class="c1">// 发出请求时的回调函数</span>
            <span class="nx">config</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// 对所有request请求中的OBJECT参数对象统一附加时间戳属性</span>
                <span class="nx">p</span><span class="p">.</span><span class="nx">timestamp</span> <span class="o">=</span> <span class="o">+</span><span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'config request: '</span><span class="p">,</span> <span class="nx">p</span><span class="p">);</span>
                <span class="c1">// 必须返回OBJECT参数对象，否则无法发送请求到服务端</span>
                <span class="k">return</span> <span class="nx">p</span><span class="p">;</span>
            <span class="p">},</span>

            <span class="c1">// 请求成功后的回调函数</span>
            <span class="nx">success</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// 可以在这里对收到的响应数据对象进行加工处理</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'request success: '</span><span class="p">,</span> <span class="nx">p</span><span class="p">);</span>
                <span class="c1">// 必须返回响应数据对象，否则后续无法对响应数据进行处理</span>
                <span class="k">return</span> <span class="nx">p</span><span class="p">;</span>
            <span class="p">},</span>

            <span class="c1">//请求失败后的回调函数</span>
            <span class="nx">fail</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'request fail: '</span><span class="p">,</span> <span class="nx">p</span><span class="p">);</span>
                <span class="c1">// 必须返回响应数据对象，否则后续无法对响应数据进行处理</span>
                <span class="k">return</span> <span class="nx">p</span><span class="p">;</span>
            <span class="p">},</span>

            <span class="c1">// 请求完成时的回调函数(请求成功或失败都会被执行)</span>
            <span class="nx">complete</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'request complete: '</span><span class="p">,</span> <span class="nx">p</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="数据绑定">数据绑定</h2>

<hr />

<p>原生小程序的数据绑定方式
原生小程序通过Page提供的setData方法来绑定数据，如：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span><span class="na">title</span><span class="p">:</span> <span class="s1">'this is title'</span><span class="p">});</span>
</code></pre></div></div>
<p>因为小程序架构本身原因，页面渲染层和JS逻辑层分开的，setData操作实际就是JS逻辑层与页面渲染层之间的通信，那么如果在同一次运行周期内多次执行setData操作时，那么通信的次数是一次还是多次呢？这个取决于API本身的设计。</p>

<p><code class="highlighter-rouge">WePY数据绑定方式</code>
WePY使用脏数据检查对setData进行封装，在函数运行周期结束时执行脏数据检查，一来可以不用关心页面多次setData是否会有性能上的问题，二来可以更加简洁去修改数据实现绑定，不用重复去写setData方法。代码如下：</p>

<blockquote>
  <p>this.title = ‘this is title’;</p>
</blockquote>

<p>需注意的是，在异步函数中更新数据的时候，必须手动调用$apply方法，才会触发脏数据检查流程的运行。如：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="s1">'this is title'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$apply</span><span class="p">();</span>
<span class="p">},</span> <span class="mi">3000</span><span class="p">);</span>
</code></pre></div></div>

<p>WePY脏数据检查流程
在执行脏数据检查时，会通过this.$$phase标识当前检查状态，并且会保证在并发的流程当中，只会有一个脏数据检查流程在运行，以下是执行脏数据检查的流程图：</p>

<p><img src="https://cloud.githubusercontent.com/assets/2182004/20554709/a0d8b1e8-b198-11e6-9034-0997b33bdf95.png" alt="" /></p>

<h2 id="其它优化细节">其它优化细节</h2>

<hr />

<ol>
  <li>wx.request 接收参数修改</li>
</ol>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 原生代码:</span>

<span class="nx">wx</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'xxx'</span><span class="p">,</span>
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// WePY 使用方式, 需要开启 Promise 支持，参考开发规范章节</span>
<span class="nx">wepy</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s1">'xxxx'</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">d</span><span class="p">));</span>

<span class="c1">// async/await 的使用方式, 需要开启 Promise 和 async/await 支持，参考 WIKI</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">request</span> <span class="p">()</span> <span class="p">{</span>
   <span class="kd">let</span> <span class="nx">d</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s1">'xxxxx'</span><span class="p">);</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">d</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>优化事件参数传递</li>
</ol>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 原生的事件传参方式:</span>

<span class="o">&lt;</span><span class="nx">view</span> <span class="nx">data</span><span class="o">-</span><span class="nx">id</span><span class="o">=</span><span class="s2">""</span> <span class="nx">data</span><span class="o">-</span><span class="nx">title</span><span class="o">=</span><span class="s2">"wepy"</span> <span class="nx">data</span><span class="o">-</span><span class="nx">other</span><span class="o">=</span><span class="s2">"otherparams"</span> <span class="nx">bindtap</span><span class="o">=</span><span class="s2">"tapName"</span><span class="o">&gt;</span> <span class="nx">Click</span> <span class="nx">me</span><span class="o">!</span> <span class="o">&lt;</span><span class="sr">/view</span><span class="err">&gt;
</span>
<span class="nx">Page</span><span class="p">({</span>
    <span class="na">tapName</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span><span class="c1">// output: 1</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">title</span><span class="p">)</span><span class="c1">// output: wepy</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">other</span><span class="p">)</span><span class="c1">// output: otherparams</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// WePY 1.1.8以后的版本，只允许传string。</span>

<span class="o">&lt;</span><span class="nx">view</span> <span class="p">@</span><span class="nd">tap</span><span class="o">=</span><span class="s2">"tapName(, 'wepy', 'otherparams')"</span><span class="o">&gt;</span> <span class="nx">Click</span> <span class="nx">me</span><span class="o">!</span> <span class="o">&lt;</span><span class="sr">/view</span><span class="err">&gt;
</span>
<span class="na">methods</span><span class="p">:</span> <span class="p">{</span>
    <span class="nx">tapName</span> <span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">title</span><span class="p">,</span> <span class="nx">other</span><span class="p">,</span> <span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">title</span><span class="p">,</span> <span class="nx">other</span><span class="p">)</span><span class="c1">// output: 1, wepy, otherparams</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>改变数据绑定方式</li>
</ol>

<p>保留setData方法，但不建议使用setData执行绑定，修复传入undefined的bug，并且修改入参支持： this.setData(target, value) this.setData(object)</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 原生代码:</span>

<span class="o">&lt;</span><span class="nx">view</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="sr">/view</span><span class="err">&gt;
</span>
<span class="nx">onLoad</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span><span class="na">message</span><span class="p">:</span> <span class="s1">'hello world'</span><span class="p">});</span>
<span class="p">}</span>


<span class="c1">// WePY</span>
<span class="o">&lt;</span><span class="nx">view</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="sr">/view</span><span class="err">&gt;
</span>
<span class="nx">onLoad</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="s1">'hello world'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>组件代替模板和模块</li>
</ol>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 原生代码:</span>

<span class="c">&lt;!--</span> <span class="nx">item</span><span class="p">.</span><span class="nx">wxml</span> <span class="o">--&gt;</span>
<span class="o">&lt;</span><span class="nx">template</span> <span class="nx">name</span><span class="o">=</span><span class="s2">"item"</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">text</span><span class="o">&gt;&lt;</span><span class="sr">/text</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="c">&lt;!--</span> <span class="nx">index</span><span class="p">.</span><span class="nx">wxml</span> <span class="o">--&gt;</span>
<span class="o">&lt;</span><span class="k">import</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"item.wxml"</span><span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="nx">template</span> <span class="nx">is</span><span class="o">=</span><span class="s2">"item"</span> <span class="nx">data</span><span class="o">=</span><span class="s2">""</span><span class="o">/&gt;</span>

<span class="c">&lt;!--</span> <span class="nx">index</span><span class="p">.</span><span class="nx">js</span> <span class="o">--&gt;</span>
<span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'item.js'</span><span class="p">)</span>




<span class="c1">// WePY</span>
<span class="c">&lt;!--</span> <span class="o">/</span><span class="nx">components</span><span class="o">/</span><span class="nx">item</span><span class="p">.</span><span class="nx">wpy</span> <span class="o">--&gt;</span>
 <span class="o">&lt;</span><span class="nx">text</span><span class="o">&gt;&lt;</span><span class="sr">/text</span><span class="err">&gt;
</span>
<span class="c">&lt;!--</span> <span class="nx">index</span><span class="p">.</span><span class="nx">wpy</span> <span class="o">--&gt;</span>
<span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">com</span><span class="o">&gt;&lt;</span><span class="sr">/com</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
    <span class="k">import</span> <span class="nx">wepy</span> <span class="k">from</span> <span class="s1">'wepy'</span><span class="p">;</span>
    <span class="k">import</span> <span class="nx">Item</span> <span class="k">from</span> <span class="s1">'../components/item'</span><span class="p">;</span>
    <span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Index</span> <span class="kd">extends</span> <span class="nx">wepy</span><span class="p">.</span><span class="nx">page</span> <span class="p">{</span>
        <span class="nx">components</span> <span class="o">=</span> <span class="p">{</span> <span class="na">com</span><span class="p">:</span> <span class="nx">Item</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<h2 id="存在的问题">存在的问题</h2>

<hr />

<p>WePY 1.x 版本中，组件使用的是静态编译组件，即组件是在编译阶段编译进页面的，每个组件都是唯一的一个实例，目前只提供简单的 repeat 支持。不支持在 repeat 的组件中去使用 props, computed, watch 等等特性。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--</span> <span class="err">错误使用</span> <span class="o">---&gt;</span>
<span class="c1">// list.wpy</span>
<span class="o">&lt;</span><span class="nx">view</span><span class="o">&gt;&lt;</span><span class="sr">/view</span><span class="err">&gt;
</span>
<span class="c1">// index.wpy</span>
<span class="o">&lt;</span><span class="nx">repeat</span> <span class="k">for</span><span class="o">=</span><span class="s2">""</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="nx">List</span> <span class="p">:</span><span class="nx">test</span><span class="p">.</span><span class="nx">sync</span><span class="o">=</span><span class="s2">"item"</span><span class="o">&gt;&lt;</span><span class="sr">/List</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/repeat</span><span class="err">&gt;
</span>
<span class="c">&lt;!--</span> <span class="err">推荐用法</span> <span class="o">---&gt;</span>
<span class="c1">// list.wpy</span>
<span class="o">&lt;</span><span class="nx">repeat</span> <span class="k">for</span><span class="o">=</span><span class="s2">""</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">view</span><span class="o">&gt;&lt;</span><span class="sr">/view</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/repeat</span><span class="err">&gt;
</span>
<span class="c1">// index.wpy</span>
<span class="o">&lt;</span><span class="nx">List</span> <span class="p">:</span><span class="nx">mylist</span><span class="p">.</span><span class="nx">sync</span><span class="o">=</span><span class="s2">"mylist"</span><span class="o">&gt;&lt;</span><span class="sr">/List</span><span class="err">&gt;
</span></code></pre></div></div>

<blockquote>
  <p>另外，在 1.7.2-alpha4 的实验版本中提供了对原生组件的支持。</p>
</blockquote>

<p><a href="https://tencent.github.io/wepy/document.html#/?id=wepyconfigjs%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E">转载自微信小程序组件化开发框架WePY官方文档</a></p>

        <div class="page-footer">
          <div class="page-tag">
            <span>Tags:</span>
            
            <a href="/tags#Wechat" class="tag">| Wechat</a>
            
            <a href="/tags#wepy" class="tag">| wepy</a>
            
          </div><!-- End Tags -->
          <div class="page-share">
            <span>Share:</span>
            <a href="https://twitter.com/intent/tweet?text=wepy (二)&url=http://localhost:4000/wepy2/" title="Share on Twitter" rel="nofollow" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
            <a href="https://facebook.com/sharer.php?u=http://localhost:4000/wepy2/" title="Share on Facebook" rel="nofollow" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
            <a href="https://plus.google.com/share?url=http://localhost:4000/wepy2/" title="Share on Google+" rel="nofollow" target="_blank"><i class="fa fa-google" aria-hidden="true"></i></a>
						
			<!-- JiaThis Button BEGIN -->
			<div class="jiathis_style_32x32">
				<a class="jiathis_button_weixin"></a>
				<a class="jiathis_button_tsina"></a>
				<!--<a class="jiathis_button_tqq"></a>
				<a class="jiathis_button_qzone"></a>
				<a class="jiathis_button_renren"></a>-->
				<a href="http://www.jiathis.com/share?uid=2157296" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
				<a class="jiathis_counter_style"></a>
			</div>
			<script type="text/javascript">var jiathis_config = {data_track_clickback:'true'};</script>
			<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=2157296" charset="utf-8"></script>
			<!-- JiaThis Button END -->
          </div><!-- End Share -->
		  
		
		  
		  <section>
			<!--<div style="background:#000;border-bottom: 1px solid #d9d9d9;"></div> -->

            <div class="content-play">
              <p><a href="javascript:void(0)" onclick="dashangToggle()" class="dashang" title="打赏，支持一下">打赏一下呗</a></p>
              <div class="hide_box-play"></div>
              <div class="shang_box-play">
                <a class="shang_close-play" href="javascript:void(0)" onclick="dashangToggle()" title="关闭"><img src="/assets/img/close.jpg" alt="取消" /></a>
                <div class="shang_tit-play">
                  <p>对你有帮助，那就打赏一下吧</p>
                </div>
				
				<div class="shang_payimg">    
                    <img src="/assets/img/wechatimg.jpg" alt="扫码支持" title="扫一扫"/>
                </div>
				
				 <div class="pay_item" data-id="weipay">
                    <span class="pay_logo"><img src="/assets/img/wechat.jpg" alt="微信" /></span>
                  </div>
				
                <div class="shang_payimg">
                    <img src="/assets/img/alipayimg.jpg" alt="扫码支持" title="扫一扫" />
                </div>
				
				 <div class="pay_item checked" data-id="alipay">
                    <span class="pay_logo"><img src="/assets/img/alipay.jpg" alt="支付宝" /></span>
                  </div>
				
                <div class="pay_explain">扫码打赏,金额随意</div>
               
              </div>
            </div>
            <script type="text/javascript">
            function dashangToggle(){
              $(".hide_box-play").fadeToggle();
              $(".shang_box-play").fadeToggle();
            }
            </script>

            <div style="text-align:center;margin:50px 0; font:normal 14px/24px 'MicroSoft YaHei';"></div>

            <style type="text/css">
              .content-play{width:100%;margin-top: 20px;margin-bottom: 10px;height:40px;text-align:center;}
              .hide_box-play{z-index:999;filter:alpha(opacity=50);background:#666;opacity: 0.5;-moz-opacity: 0.5;left:0;top:0;height:99%;width:100%;position:fixed;display:none;}
              .shang_box-play{width:100%;height:540px;padding:10px;background-color:#fff;border-radius:10px;position:fixed;z-index:1000;left:0%;top:50%;margin-left:0px;margin-top:-280px;border:1px dotted #dedede;display:none;}
              .shang_box-play img{border:none;border-width:0;}
              .dashang{width:100px;margin:5px auto;height:25px;line-height:25px;padding:10px;background-color:#E74851;color:#fff;text-align:center;text-decoration:none;border-radius:10px;font-weight:bold;font-size:16px;transition: all 0.3s;}
              .dashang:hover{opacity:0.8;padding:15px;font-size:18px;}
              .shang_close-play{float:right;display:inline-block;
                margin-right: 10px;margin-top: 20px;
              }
              .shang_logo{display:block;text-align:center;margin:20px auto;}
              .shang_tit-play{width: 100%;height: 75px;text-align: center;line-height: 66px;color: #a3a3a3;font-size: 16px;background: url('/images/payimg/cy-reward-title-bg.jpg');font-family: 'Microsoft YaHei';margin-top: 7px;margin-right:2px;}
              .shang_tit-play p{color:#a3a3a3;text-align:center;font-size:16px;}
              .shang_payimg{padding:10px;/*border:6px solid #EA5F00;**/margin:0 auto;border-radius:3px;height:140px;display:inline-block;}
              .shang_payimg img{display:inline-block;margin-right:10px;float:left;text-align:center;width:140px;height:140px; }
              .pay_explain{text-align:center;margin:10px auto;font-size:12px;color:#545454;}
              .shang_payselect{text-align:center;margin:0 auto;margin-top:40px;cursor:pointer;height:60px;width:500px;margin-left:110px;}
              .shang_payselect .pay_item{display:inline-block;margin-right:140px;float:left;}
              .shang_info-play{clear:both;}
              .shang_info-play p,.shang_info-play a{color:#C3C3C3;text-align:center;font-size:12px;text-decoration:none;line-height:2em;}
            </style>

       <ul class="pager">
	    
        <li class="previous">
            <a href="/wepy3/" data-toggle="tooltip" data-placement="top" title="wepy (三)">上一篇：  <span>wepy (三)</span>
            </a>
        </li>
		
		<br><br>
		
        
        
        <li class="next">
            <a href="/wepy1/" data-toggle="tooltip" data-placement="top" title="wepy (一)">下一篇：  <span>wepy (一)</span>
            </a>
        </li>
        
    </ul>
</section>

        </div>
		
		
        <section class="author-box">
  <img src="/assets/img/leach-face.jpg" alt="nldrs" class="author-img">
  <div class="author-desc">
    <h2>nldrs</h2>
    <p>码农，嘿说你呢！！？</p>
    <ul>
      
        <li class="email"><a href="mailto:lpfwch777@gmail.com"><i class="fa fa-envelope-o"></i></a></li>
      
      
        <li class="phone"><a href="tel:0"><i class="fa fa-phone"></i></a></li>
      
      <!--
        <li class="website"><a href="https://artemsheludko.github.io" target="_blank"><i class="fa fa-globe" aria-hidden="true"></i></a></li>
      
      
        <li class="twitter"><a href="https://twitter.com/artemsheludko_" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
      -->
    </ul>
  </div>
</section>

        <div class="recent-box">
  <h2 class="recent-title">Recent post</h2>
  <div class="recent-list">
    
      
        <a href="/mysql/" class="recent-item" style="background: url(/assets/img/lpf-10.jpg) center no-repeat; background-size: cover;"><span>mysql 学习</span></a>
      
    
      
        <a href="/uniapp6/" class="recent-item" style="background: url(/assets/img/lpf-50.jpg) center no-repeat; background-size: cover;"><span>uni-app 的总结(echarts)</span></a>
      
    
      
        <a href="/work/" class="recent-item" style="background: url(/assets/img/wch6.jpg) center no-repeat; background-size: cover;"><span>入职的第二周</span></a>
      
    
      
        <a href="/arr/" class="recent-item" style="background: url(/assets/img/wch4.jpg) center no-repeat; background-size: cover;"><span>JavaScript 数组去重</span></a>
      
    
  </div>
</div> <!-- End Recent-Box -->

        <div class="newsletter" id="mc_embed_signup" style="display:none">
  <h2 class="newsletter-title">Newsletter</h2>
  <div class="form-container">
    <p>Subscribe here to get our latest updates</p>
    <form action="//" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
      <label class="screen-reader-text" for="mce-EMAIL">Email Address</label>
      <div class="newsletter-box" id="mc_embed_signup_scroll">
        <input type="email" name="EMAIL" placeholder="Email address" class="email-input" id="mce-EMAIL" required>
        <input type="submit" value="Subscribe" name="subscribe" class="subscribe-btn" id="mc-embedded-subscribe">
      </div>
    </form>
  </div>
</div> <!-- End Newsletter -->

        <section class="comment-area">
  <div class="comment-wrapper">
   
	  <div id="disqus_thread" class="article-comments"></div>
	    <script>
			var idcomments_acct = '8b1583de29c0b1f23510ee43fce7d4e7';
			var idcomments_post_id;
			var idcomments_post_url;
		</script>
		<span id="IDCommentsPostTitle" style="display:none"></span>
		<script type='text/javascript' src='https://www.intensedebate.com/js/genericCommentWrapperV2.js'></script>
	
  </div>
</section>
      </div>
    </div> <!-- End Wrapper -->
  </article>
  <div class="search-box">
  <div class="wrapper">
    <div class="search-grid">
      <form class="search-form">
        <div id="search-container">
          <input type="text" id="search-input" class="search" placeholder="Search">
        </div>
      </form>
      <ul id="results-container" class="results-search"  style="height:400px;overflow-y:scroll;overflow-y:auto;"></ul>
      <div class="icon-close-container">
        <span class="search-icon-close"><i class="fa fa-times" aria-hidden="true"></i></span>
      </div>
    </div>
  </div>
</div>

  <footer class="main-footer">
	<div class="footer-social">
		<div class="footer-container clearfix">
			<div class="social-list">
				<a class="social github" target="blank" href="https://github.com/nldrs">GitHub</a>
				<a class="social github" target="blank" href="https://www.jianshu.com/u/042fe873dc7c">简书</a>
				<a class="social github" target="blank" href="https://juejin.im/user/5a20a378f265da4311200031/collections">掘金</a>
				<a class="social github" target="blank" href="http://blog.csdn.net/">Csdn</a>
			</div>
		</div>
	</div>

	<div class="copyright">
		<p>2018 &copy; nldrs</p>
		
			
	<div style="font-size:12px;color:#B3B3B3;padding-right:30px;float:right"> 
		<iframe
                style="margin-left: 2px; margin-bottom:-5px;"
                frameborder="0" scrolling="0" width="91px" height="20px"
                src="https://ghbtns.com/github-btn.html?user=leach-chen&repo=leach-chen.github.io&type=star&count=true" >
            </iframe>
		<span id="busuanzi_container_site_pv">本站总访问量：<span id="busuanzi_value_site_pv"></span>次</span>
	</div>
	</div>

</footer> <!-- End Footer -->

</div>

  
  
<div class="top" title="Top"><i class="fa fa-chevron-up" aria-hidden="true"></i></div> <!-- End Top Scroll -->
  <!-- JS -->
<script src="/assets/js/jquery-3.2.1.min.js"></script>
<script src="/assets/js/jekyll-search.js"></script>
<script>
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('results-container'),
    json: '/search.json',
    searchResultTemplate: '<li><a href="{url}" title="{desc}">{title}</a></li>',
    noResultsText: 'No results found',
    fuzzy: false,
    exclude: ['Welcome']
  });
</script>
<script src="/assets/js/main.js"></script>

  <!--<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', '', 'auto');
  ga('send', 'pageview');
</script> <!-- End Analytics -->

</body>
</html>
